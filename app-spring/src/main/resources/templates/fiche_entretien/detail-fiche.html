<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: taghead"></head>
<body>
    <div th:replace="fragments/menu :: tagmenu">  </div>
    <br/>
    <a class="btn btn-danger mb-2 float-right" th:onclick="${fiche.setValid(false)}" th:href="@{/entretien/list}">Annuler la fiche</a>
    <a class="btn btn-primary mb-2 float-right">Modifier la fiche</a>
    <a class="btn btn-success mb-2 float-right" th:unless="${fiche.isCloture()}" th:onclick="${fiche.setCloture(true)}">Cloturer</a>
    <div class="container">
        <fieldset class="form-group border p-3">
            <legend class="w-auto px-2"><h1>Fiche d'entretien</h1></legend>
            <div class="form-group">
                <table class="table">
                    <tbody>
                        <tr>
                            <td>Référence : </td>
                            <td th:text="${fiche.id}"></td>
                        </tr>
                        <tr>
                            <td>Client : </td>
                            <td th:text="${fiche.client.prenom} + ' ' + ${fiche.client.nom}"></td>
                        </tr>
                        <tr>
                            <td>Date de création : </td>
                            <td th:text="${fiche.dateCreation}"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <hr/>
            <div class="form-group">
                <h2>Liste des taches</h2>
                <table class="table table-striped">
                    <thead class="thead-dark">
                    <tr>
                        <th>N°</th>
                        <th>Type</th>
                        <th>Pièces nécessaires</th>
                        <th>Assignation</th>
                        <th>Priorité</th>
                        <th>Etat</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="tache: ${fiche.taches}">
                        <td th:text="${tache.id}"></td>
                        <td th:text="${tache.type}"></td>
                        <td th:text="${tache}"></td>
                        <td th:text="${tache.mecanicienAttribue.prenom} + ' ' + ${tache.mecanicienAttribue.nom}"></td>
                        <td th:text="${tache.priorite}"></td>
                        <td>
                            <span th:if="${tache.terminee}">Terminée</span>
                            <span th:unless="${tache.terminee}">A faire</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <a class="btn btn-danger float-right" th:href="@{/entretien/list}">Retour</a>
        </fieldset>
    </div>
</body>
</html>